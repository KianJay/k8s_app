{% load static %}
<!-- Bootstrap -->
<link rel="stylesheet" type="text/css" href="/front/assets/vendor/bootstrap/css/bootstrap.min.css" />
<!-- <link rel="stylesheet" type="text/css" href="(% static 'assets/vendor/bootstrap/css/bootstrap.min.css' %}" /> -->
<script src="https://www.google.com/recaptcha/api.js" async defer></script>
<link href="{% static 'assets/images/favicon.png' %}" rel="icon" />
<div class="idocs-content">
  <a class="logo ml-md-3 "  href="index" title="wikikube"> <img src="{% static 'assets/images/logo.png' %}" height="auto" width="160px" alt="wikikube"/> </a> 
<div class="container mt-5">
 
  <div class="row">
      <div class="col-md-12">
          <div class="well well-sm">
              <form class="form-horizontal" method="post" id="contact-us-form" name="form">
          
                  <fieldset>
                      <h3 class="text-left header">Feedback</h3>

                      <div class="form-group"  >
                          <span class="col-md-1 col-md-offset-2 text-center"></span>
                          <div class="col-md-8">
                              <p>Name</p>
                              <input name="name" type="text" class="form-control"  placeholder="Name">
                              {% csrf_token %}
                          </div>
                      </div>

                      <div class="form-group">
                          <span class="col-md-1 col-md-offset-2 text-center"><i class="fa fa-envelope-o bigicon"></i></span>
                          <div class="col-md-8">
                              <p>E-mail</p>
                              <input id="email" name="email" type="text" maxlength="50" class="form-control" placeholder="E-mail address">
                          </div>
                      </div>
                      <div class="form-group">
                          <span class="col-md-1 col-md-offset-2 text-center"></span>
                          <div class="col-md-8">
                              <p>Message</p>
                              <textarea class="form-control" id="message" name="message" rows="7"  placeholder="Message"></textarea>
                          </div>
                      </div>
                      <div class="g-recaptcha" data-sitekey="6LfPFggbAAAAAAjfr7I6jQ7D6YAkqCOjNmOzZqCm"></div>
                      <p id="result-text"></p>
                      <div class="form-group">
                        
                              <input type="submit" name="submit" id="submit" value="Submit" class="btn" ></input>
                            <a href="{% url 'index' %}" type="cancel" class="btn" name="cancel" id="cancel">Cancel</a>
                            <div id="response"></div>
               
                        </div>
                        <div class="col-md-12 text-center">
                  </fieldset>
              
              </form>
          </div>
      </div>
  </div>
</div>

<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit"
async defer> 
</script>
<script type="text/javascript">
    var onloadCallback = function() {
      grecaptcha.render('html_element', {
        'sitekey' : '6LfPFggbAAAAAAjfr7I6jQ7D6YAkqCOjNmOzZqCm'
      });
    };
  </script>
<script>

    // submit endpoint
    const form = document.querySelector("form");
    form.addEventListener("submit", (event) => {
      // prevent the form submit from refreshing the page
    event.preventDefault();
    
      const { name, email, message } = event.target;
    
        // Use your API endpoint URL you copied from the previous step
      const endpoint =
        "https://9gptd31rq4.execute-api.ap-northeast-2.amazonaws.com/default/sendEmail";
      // We use JSON.stringify here so the data can be sent as a string via HTTP
        const body = JSON.stringify({
        senderName: name.value,
        senderEmail: email.value,
        message: message.value
      });
      const requestOptions = {
        method: "POST",
        body
      };
    
      fetch(endpoint, requestOptions)
        .then((response) => {
          if (!response.ok) throw new Error("Error in fetch");
          return response.json();
        })
        .then((response) => {
          document.getElementById("result-text").innerText =
            "Email sent successfully!";
        })
        .catch((error) => {
          document.getElementById("result-text").innerText =
            "An unkown error occured.";
        })
    });
    </script>